<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Binance Futures PnL Calculator</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
<style>
  :root {
    --primary: #fcd535;
    --bg: #0e1116;
    --surface: #1c1f26;
    --text: #ffffff;
    --muted: #a0aec0;
    --input-bg: #2d3748;
    --green: #27ae60;
    --red: #e74c3c;
  }

  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }

  body {
    font-family: 'Inter', sans-serif;
    background-color: var(--bg);
    color: var(--text);
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 40px 20px;
  }

  .container {
    max-width: 900px;
    width: 100%;
    background-color: var(--surface);
    border-radius: 16px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    padding: 40px 30px;
    transition: all 0.3s ease;
  }

  h1 {
    text-align: center;
    font-size: 32px;
    margin-bottom: 30px;
    color: var(--primary);
  }

  form {
    display: flex;
    flex-wrap: wrap;
    gap: 20px 30px;
    align-items: flex-end;
  }

  .form-group {
    display: flex;
    flex-direction: column;
    flex: 1 1 180px;
    min-width: 180px;
  }

  label {
    margin-bottom: 6px;
    font-weight: 600;
  }

  input,
  select {
    width: 100%;
    padding: 14px 16px;
    border: none;
    border-radius: 8px;
    background-color: var(--input-bg);
    color: var(--text);
    font-size: 16px;
    transition: border 0.2s;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    cursor: pointer;
    position: relative;
    padding-right: 40px;
  }

  input:focus,
  select:focus {
    outline: none;
    border: 1px solid var(--primary);
    background-color: var(--input-bg);
  }

  /* Position dropdown specific styles */
  select#position {
    color: #fff;
    font-weight: 600;
    background-image:
      linear-gradient(45deg, transparent 50%, #fff 50%),
      linear-gradient(135deg, #fff 50%, transparent 50%);
    background-position:
      calc(100% - 20px) calc(1em + 2px),
      calc(100% - 15px) calc(1em + 2px);
    background-size: 5px 5px;
    background-repeat: no-repeat;
    transition: background-color 0.3s ease;
  }

  /* Long state */
  select#position.long {
    background-color: var(--green);
  }

  /* Short state */
  select#position.short {
    background-color: var(--red);
  }

  .text-view {
    flex-basis: 100%;
    font-weight: 600;
    color: var(--primary);
    margin-bottom: 20px;
    user-select: none;
  }

  button {
    flex-basis: 100%;
    padding: 16px;
    background-color: var(--primary);
    color: #000;
    border: none;
    border-radius: 10px;
    font-size: 18px;
    font-weight: 700;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  button:hover {
    background-color: #e6c024;
  }

  .result {
    margin-top: 30px;
    background-color: #2c313a;
    padding: 20px;
    border-radius: 10px;
    font-size: 16px;
    line-height: 1.6;
    color: var(--text);
    white-space: pre-wrap;
  }

  @media (max-width: 720px) {
    form {
      flex-direction: column;
    }

    .form-group {
      min-width: 100%;
    }
  }
</style>
</head>
<body>
<div class="container" id="containerBox">
  <h1>Futures PnL Calculator</h1>
  <form id="pnlForm">
    <div class="form-group">
      <label for="position">Position Type</label>
      <select id="position" onchange="updatePositionColor()">
        <option value="long" selected>Long</option>
        <option value="short">Short</option>
      </select>
    </div>

    <div class="form-group">
      <label for="entryPrice">Entry Price</label>
      <input type="number" id="entryPrice" placeholder="e.g. 25000" step="any" />
    </div>

    <div class="form-group">
      <label for="leverage">Leverage</label>
      <input type="number" id="leverage" placeholder="e.g. 10" step="any" />
    </div>

    <div class="text-view" id="liqPriceContainer">
      Estimated Liquidation Price: <span id="liqPrice">-</span>
    </div>

    <div class="form-group">
      <label for="margin">Margin (USDT)</label>
      <input type="number" id="margin" placeholder="e.g. 100" step="any" />
    </div>

    <div class="form-group">
      <label for="closePrice">Close Price</label>
      <input type="number" id="closePrice" placeholder="e.g. 26000" step="any" />
    </div>

    <button type="submit">Calculate PnL</button>
  </form>

  <div class="result" id="result"></div>
</div>

<script>
  const entryInput = document.getElementById('entryPrice');
  const leverageInput = document.getElementById('leverage');
  const positionInput = document.getElementById('position');
  const form = document.getElementById('pnlForm');
  const liqPriceDisplay = document.getElementById('liqPrice');
  const resultDiv = document.getElementById('result');

  function updatePositionColor() {
    if (positionInput.value === 'short') {
      positionInput.classList.remove('long');
      positionInput.classList.add('short');
    } else {
      positionInput.classList.remove('short');
      positionInput.classList.add('long');
    }
    calculateLiquidationPrice();
  }

  function calculateLiquidationPrice() {
    const entry = parseFloat(entryInput.value);
    const leverage = parseFloat(leverageInput.value);
    const position = positionInput.value;

    if (!entry || !leverage || leverage === 0) {
      liqPriceDisplay.textContent = "-";
      return;
    }

    let liqPrice;
    if (position === "long") {
      liqPrice = entry * (1 - 1 / leverage);
    } else {
      liqPrice = entry * (1 + 1 / leverage);
    }

    liqPriceDisplay.textContent = liqPrice.toFixed(2);
  }

  entryInput.addEventListener('input', calculateLiquidationPrice);
  leverageInput.addEventListener('input', calculateLiquidationPrice);
  positionInput.addEventListener('change', () => {
    updatePositionColor();
    calculateLiquidationPrice();
  });

  form.addEventListener('submit', function (e) {
    e.preventDefault();

    const entry = parseFloat(entryInput.value);
    const close = parseFloat(document.getElementById('closePrice').value);
    const margin = parseFloat(document.getElementById('margin').value);
    const leverage = parseFloat(leverageInput.value);
    const position = positionInput.value;

    if (!entry || !close || !margin || !leverage || leverage === 0) {
      resultDiv.innerHTML = `<span style="color: red;">Please fill out all fields correctly.</span>`;
      return;
    }

    // Calculate position size in USDT
    const positionSize = margin * leverage;

    // Fees (taker and maker)
    const takerFeeRate = 0.0005;
    const makerFeeRate = 0.0002;

    // Fees for open and close (assuming taker fee for open, maker fee for close)
    const openFee = positionSize * takerFeeRate;
    const closeFee = positionSize * makerFeeRate;

    // PnL calculation
    let pnl;
    if (position === 'long') {
      pnl = (close - entry) * positionSize / entry;
    } else {
      pnl = (entry - close) * positionSize / entry;
    }

    // Subtract fees
    const totalFee = openFee + closeFee;
    const netPnl = pnl - totalFee;

    // Percentage PnL relative to margin
    const pnlPercent = (netPnl / margin) * 100;

    // Display results
    let pnlColor = netPnl >= 0 ? 'var(--green)' : 'var(--red)';
    resultDiv.innerHTML = `
      <strong>Position Size (USDT):</strong> ${positionSize.toFixed(2)}<br/>
      <strong>Open Fee (Taker 0.05%):</strong> ${openFee.toFixed(4)} USDT<br/>
      <strong>Close Fee (Maker 0.02%):</strong> ${closeFee.toFixed(4)} USDT<br/>
      <strong>Total Fees:</strong> ${totalFee.toFixed(4)} USDT<br/>
      <strong>PnL Before Fees:</strong> ${(pnl).toFixed(4)} USDT<br/>
      <strong style="color: ${pnlColor};">PnL After Fees:</strong> ${netPnl.toFixed(4)} USDT<br/>
      <strong style="color: ${pnlColor};">PnL Percentage:</strong> ${pnlPercent.toFixed(2)}%
    `;
  });

  // Initialize position color on page load
  updatePositionColor();
</script>

</body>
</html>
